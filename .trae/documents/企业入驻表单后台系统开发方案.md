# 企业入驻表单后台系统开发方案

## 一、系统架构设计

### 1. 技术栈选择

* **前端**：HTML/CSS/JavaScript（原有表单改造） + Vue.js（后台管理界面）

* **后端**：Node.js + Express.js

* **数据库**：MongoDB（云数据库）

* **邮件服务**：Nodemailer

* **文件存储**：MongoDB GridFS 或云存储服务

### 2. 系统模块划分

* 表单提交模块（前端）

* 后端API服务

* 数据库管理模块

* 邮件发送模块

* 后台管理界面

## 二、前端改造

1. **改造现有表单**：

   * 添加表单数据验证

   * 实现AJAX表单提交

   * 添加文件上传功能

   * 显示提交状态反馈

2. **后台管理界面**：

   * 表单列表展示（支持分页、筛选、排序）

   * 表单详情查看

   * 审核功能（单个审核、批量审核）

   * 配置管理（邮件模板、审核规则）

   * 统计报表

## 三、后端API设计

### 1. 核心API端点

* `POST /api/form/submit` - 提交表单数据

* `GET /api/form/list` - 获取表单列表

* `GET /api/form/detail/:id` - 获取表单详情

* `POST /api/form/approve` - 审核表单（单个/批量）

* `GET /api/config/email` - 获取邮件配置

* `POST /api/config/email` - 更新邮件配置

### 2. 数据模型设计

#### 表单数据模型（FormData）

```javascript
{
  _id: ObjectId,
  // 企业基础信息
  companyName: String,          // 企业全称
  socialCreditCode: String,     // 统一社会信用代码
  companyType: String,          // 企业性质
  industry: String,             // 所属行业
  registrationAddress: String,  // 企业注册地址
  
  // 对接人信息
  contactName: String,          // 对接人姓名
  contactPhone: String,         // 联系电话
  contactIdCard: String,        // 身份证号
  email: String,                // 电子邮箱
  department: String,           // 部门/职务
  referrerName: String,         // 推荐人姓名
  referrerPhone: String,        // 推荐人电话
  referrerIdCard: String,       // 推荐人身份证号
  
  // 对接业务及需求
  businessType: String,         // 对接业务类型
  demandDescription: String,    // 需求描述
  budgetRange: String,          // 预算范围
  
  // 材料上传
  files: [                      // 文件列表
    {
      name: String,             // 文件名
      type: String,             // 文件类型
      size: Number,             // 文件大小
      url: String               // 文件URL
    }
  ],
  
  // 审核信息
  status: {                     // 审核状态
    type: String,
    enum: ['pending', 'approved', 'rejected'],
    default: 'pending'
  },
  approvedBy: String,           // 审核人
  approvedAt: Date,             // 审核时间
  approvalNote: String,         // 审核备注
  
  // 元数据
  submittedAt: {                // 提交时间
    type: Date,
    default: Date.now
  },
  ipAddress: String             // 提交IP
}
```

#### 邮件配置模型（EmailConfig）

```javascript
{
  _id: ObjectId,
  smtp: {
    host: String,              // SMTP服务器地址
    port: Number,              // SMTP端口
    secure: Boolean,           // 是否使用SSL
    auth: {
      user: String,            // 邮箱用户名
      pass: String             // 邮箱密码/授权码
    }
  },
  templates: {
    approved: {
      subject: String,         // 审核通过邮件主题
      content: String          // 审核通过邮件内容
    },
    rejected: {
      subject: String,         // 审核不通过邮件主题
      content: String          // 审核不通过邮件内容
    }
  },
  updatedAt: Date              // 更新时间
}
```

## 四、功能实现

### 1. 表单提交功能

* 实现表单数据验证（前端+后端）

* 支持文件上传

* 保存到MongoDB数据库

* 返回提交结果

### 2. 后台管理功能

* **表单列表**：支持分页、筛选（按状态、时间、企业名称等）、排序

* **表单详情**：查看完整表单信息和上传文件

* **审核功能**：

  * 单个审核：查看详情后审核

  * 手动批量审核：选择多条记录批量审核

  * 自动批量审核：根据预设规则自动审核

* **配置管理**：

  * 邮件模板编辑

  * SMTP服务器配置

  * 审核规则设置

### 3. 邮件发送功能

* 使用Nodemailer发送邮件

* 支持HTML格式邮件

* 邮件模板可自定义

* 审核后自动发送邮件通知

* 支持批量发送

## 五、开发计划

### 1. 第一阶段：后端服务开发

* 搭建Node.js + Express.js项目

* 实现数据库连接和模型设计

* 开发核心API端点

* 实现文件上传功能

* 开发邮件发送模块

### 2. 第二阶段：前端改造

* 改造现有表单，添加AJAX提交功能

* 实现表单验证和错误提示

* 添加文件上传进度显示

* 开发后台管理界面（Vue.js）

### 3. 第三阶段：功能集成和测试

* 前后端联调

* 测试表单提交和数据存储

* 测试审核功能和邮件发送

* 系统性能测试和安全性测试

### 4. 第四阶段：部署和上线

* 部署后端服务到云服务器

* 配置MongoDB云数据库

* 配置SMTP邮件服务

* 上线系统并进行监控

## 六、文件结构设计

```
企业入驻表单/
├── 企业入驻表单.html           # 原有表单（改造后）
├── backend/                   # 后端服务
│   ├── package.json
│   ├── app.js                 # 主应用文件
│   ├── routes/                # API路由
│   │   ├── form.js            # 表单相关API
│   │   └── config.js          # 配置相关API
│   ├── models/                # 数据模型
│   │   ├── FormData.js
│   │   └── EmailConfig.js
│   ├── controllers/           # 控制器
│   │   ├── formController.js
│   │   └── configController.js
│   ├── services/              # 服务层
│   │   ├── emailService.js
│   │   └── fileService.js
│   ├── middleware/            # 中间件
│   │   ├── auth.js            # 认证中间件
│   │   └── validator.js       # 验证中间件
│   └── config/                # 配置文件
│       └── db.js              # 数据库配置
└── admin/                     # 后台管理界面
    ├── index.html
    ├── package.json
    ├── src/
    │   ├── main.js
    │   ├── App.vue
    │   ├── components/        # Vue组件
    │   │   ├── FormList.vue
    │   │   ├── FormDetail.vue
    │   │   └── Config.vue
    │   ├── router/            # 路由配置
    │   └── services/          # API服务
    └── dist/                  # 构建输出目录
```

## 七、安全性考虑

1. **数据验证**：前端和后端双重验证
2. **防止SQL注入**：使用ORM或参数化查询
3. **防止XSS攻击**：输入输出过滤
4. **文件上传安全**：文件类型验证、大小限制、病毒扫描
5. **API认证**：后台管理API添加JWT认证
6. **敏感数据加密**：如身份证号、联系方式等
7. **CORS配置**：限制跨域请求
8. **日志记录**：关键操作日志记录

## 八、扩展性设计

1. **模块化设计**：便于后续功能扩展
2. **API版本控制**：支持多版本API
3. **插件机制**：支持第三方服务集成
4. **统计分析**：可扩展添加数据分析功能
5. **多语言支持**：预留多语言接口

## 九、部署方案

1. **后端服务**：部署到云服务器（如阿里云、腾讯云）或使用Serverless服务
2. **数据库**：使用MongoDB Atlas云数据库
3. **文件存储**：根据需求选择MongoDB GridFS或云存储服务（如OSS、COS）
4. **邮件服务**：使用企业邮箱或第三方邮件服务（如SendGrid、阿里云邮件推送）

## 十、开发时间估计

1. 后端服务开发：3-4天
2. 前端改造：2-3天
3. 后台管理界面：3-4天
4. 功能集成和测试：2-3天
5. 部署和上线：1-2天

总计：11-16天

## 十一、预期效果

1. 表单数据安全存储到云端数据库
2. 后台可实时查看和管理表单数据
3. 支持灵活的审核机制（单个/批量/自动）
4. 自动发送审核结果通知邮件
5. 邮件模板可自定义配置
6. 系统具有良好的扩展性和安全性
7. 操作

